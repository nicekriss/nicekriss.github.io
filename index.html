<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>제이엘디자인</title>
  <meta name="description" content="제이엘디자인 — 인테리어 시공 갤러리와 문의">
  <link rel="icon" href="favicon.svg" type="image/svg+xml">
  <!-- Open Graph -->
  <meta property="og:title" content="제이엘디자인">
  <meta property="og:description" content="공간을 새롭게, 삶을 아름답게">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://nicekriss.github.io/">
  <style>
    :root{--bg:#0b0f14;--panel:#121826;--line:#1b2335;--text:#f6f7fb;--muted:#9aa4b2;--brand:#00d4b3}
    *{box-sizing:border-box}body{margin:0;font-family:system-ui,-apple-system,"Noto Sans KR",sans-serif;background:var(--bg);color:var(--text)}
    header{position:relative;padding:72px 16px 56px;text-align:center;background:
      radial-gradient(1000px 400px at 50% -20%, #1b2540 20%, transparent 60%),
      linear-gradient(180deg,#0e1320,#0b0f14);border-bottom:1px solid var(--line);overflow:hidden}
    header:after{content:"";position:absolute;inset:-40% -10% auto -10%;height:220px;
      background:conic-gradient(from 120deg,#00d4b3 0 25%,#7c9cf5 25% 50%,#9b87f5 50% 75%,transparent 75% 100%);
      filter:blur(80px);opacity:.15;pointer-events:none}
    h1{margin:10px 0 6px;font-size:34px;letter-spacing:.3px}
    .tagline{margin:0 auto;max-width:720px;color:var(--muted)}
    #logo{height:64px;filter:drop-shadow(0 4px 8px rgba(0,0,0,.25))}
    nav{display:flex;gap:16px;justify-content:center;padding:12px 16px;border-bottom:1px solid var(--line);background:#0e1422;position:sticky;top:0;z-index:5}
    nav a{color:var(--text);text-decoration:none;padding:8px 12px;border-radius:10px}
    nav a:hover{background:#172038}
    .cta{margin-top:18px;display:flex;gap:10px;justify-content:center;flex-wrap:wrap}
    .btn{background:rgba(0,212,179,.12);border:1px solid #1e3b37;color:#eafff9;text-decoration:none;padding:10px 14px;border-radius:10px}
    .btn:hover{background:rgba(0,212,179,.18)}
    section{max-width:1200px;margin:28px auto;padding:0 16px}
    h2{font-size:22px;margin:0 0 18px}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:18px}
    .card{background:var(--panel);border:1px solid var(--line);border-radius:16px;overflow:hidden;cursor:pointer;transition:transform .15s ease,box-shadow .15s ease}
    .card:hover{transform:translateY(-2px);box-shadow:0 10px 24px rgba(0,0,0,.25)}
    .thumb{width:100%;aspect-ratio:4/3;object-fit:cover;display:block;filter:saturate(1.02)}
    .meta{padding:12px 14px}
    .title{font-size:16px;margin-bottom:6px}
    .desc{font-size:13px;color:var(--muted)}
    .contact-list{display:flex;gap:10px;flex-wrap:wrap}.contact-list a{color:#bfeee6}
    footer{text-align:center;color:var(--muted);padding:28px 16px;border-top:1px solid var(--line);margin-top:36px}
    .lightbox{position:fixed;inset:0;background:rgba(0,0,0,.92);display:none;align-items:center;justify-content:center;padding:24px;z-index:50}
    .lightbox.open{display:flex}.lightbox img{max-width:95vw;max-height:85vh;border-radius:12px}
    .ctrl{position:absolute;top:16px;background:rgba(255,255,255,.12);border:1px solid #ffffff22;color:#fff;padding:8px 12px;border-radius:10px;cursor:pointer;backdrop-filter:blur(4px)}
    #btnClose{right:16px}#btnPrev,#btnNext{top:50%;transform:translateY(-50%)}#btnPrev{left:16px}#btnNext{right:16px}
    .counter{position:absolute;bottom:18px;left:50%;transform:translateX(-50%);color:#fff;background:rgba(0,0,0,.35);padding:6px 10px;border-radius:8px;font-size:12px}
    @media (prefers-reduced-motion: reduce){.card{transition:none}}
  </style>
</head>
<body>
  <!-- ▼ 사이트 기본 정보만 바꾸면 전역 반영 -->
  <script>
    const SITE = {
      name   : "제이엘디자인",
      tagline: "공간을 새롭게, 삶을 아름답게",
      phone  : "010-6436-6401",
      email  : "jldesign77@naver.com",
      kakao  : "http://pf.kakao.com/_xeigDxj/chat"
    };
    const IMG_BASE = "wm_images";   // 워터마크 이미지 루트
    const IMG_FALLBACK = "images";  // 폴백 루트
    document.title = SITE.name;
  </script>

  <header>
    <img id="logo" src="jl_monogram_luxe.svg" alt="제이엘디자인 로고" decoding="async" loading="eager">
    <h1 id="brand">제이엘디자인</h1>
    <p class="tagline" id="tagline">공간을 새롭게, 삶을 아름답게</p>
    <div class="cta" aria-label="빠른 문의">
      <a class="btn" id="btnCall"   href="#" aria-label="전화 걸기">전화 문의</a>
      <a class="btn" id="btnKakao"  href="http://pf.kakao.com/_xeigDxj/chat" target="_blank" rel="noopener">카카오톡 상담</a>
      <a class="btn" id="btnEmail"  href="#" aria-label="이메일 보내기">이메일 문의</a>
    </div>
  </header>

  <nav role="navigation" aria-label="주요 메뉴">
    <a href="#projects" aria-current="page">시공 갤러리</a>
    <a href="#contact">문의하기</a>
  </nav>

  <section id="projects">
    <h2>시공 갤러리</h2>
    <div class="grid" id="grid" aria-live="polite"></div>
  </section>

  <section id="contact">
    <h2>문의하기</h2>
    <div class="contact-list" id="contactList"></div>
  </section>

  <footer>© <span id="year"></span> <span id="brandFoot">제이엘디자인</span></footer>

  <!-- 라이트박스 -->
  <div class="lightbox" id="lightbox" aria-modal="true" role="dialog" aria-label="이미지 보기">
    <img id="lightImg" alt="">
    <button class="ctrl" id="btnClose">닫기</button>
    <button class="ctrl" id="btnPrev" aria-label="이전 이미지">←</button>
    <button class="ctrl" id="btnNext" aria-label="다음 이미지">→</button>
    <div class="counter" id="counter" aria-live="polite"></div>
  </div>

  <script>
    // 초기 세팅
    const $=s=>document.querySelector(s);
    const logo=$('#logo'); logo.onerror=()=>logo.style.display='none';
    $('#brand').textContent=SITE.name; $('#tagline').textContent=SITE.tagline;
    $('#brandFoot').textContent=SITE.name; $('#year').textContent=new Date().getFullYear();
    $('#btnCall').href='tel:'+SITE.phone.replaceAll('-',''); $('#btnEmail').href='mailto:'+SITE.email; $('#btnKakao').href=SITE.kakao;
    $('#contactList').innerHTML=`전화 <a href="tel:${SITE.phone.replaceAll('-','')}">${SITE.phone}</a> · 이메일 <a href="mailto:${SITE.email}">${SITE.email}</a> · <a href="${SITE.kakao}" target="_blank" rel="noopener">카카오톡</a>`;

    // 갤러리 렌더
    const grid=$('#grid'), lightbox=$('#lightbox'), lightImg=$('#lightImg'), counter=$('#counter');
    const btnClose=$('#btnClose'), btnPrev=$('#btnPrev'), btnNext=$('#btnNext');

    let projects=[]; let cur={p:-1,i:0};

    function setImgWithFallback(el, primary, fallback){
      el.src=primary; el.onerror=()=>{el.onerror=null; el.src=fallback;}
    }

    function card(p, idx){
      const wrap=document.createElement('article'); wrap.className='card'; wrap.tabIndex=0; wrap.setAttribute('aria-label',(p.title||p.id)+' 보기');
      const img=document.createElement('img'); img.className='thumb'; img.decoding='async'; img.loading='lazy';
      setImgWithFallback(img, `${IMG_BASE}/${p.id}/${p.cover}`, `${IMG_FALLBACK}/${p.id}/${p.cover}`);
      img.alt=p.title||p.id;
      const meta=document.createElement('div'); meta.className='meta';
      const t=document.createElement('div'); t.className='title'; t.textContent=p.title||p.id;
      const d=document.createElement('div'); d.className='desc'; d.textContent=p.desc||'';
      meta.appendChild(t); if(p.desc) meta.appendChild(d);
      wrap.append(img, meta);
      const open=()=>openLightbox(idx,0);
      wrap.addEventListener('click', open);
      wrap.addEventListener('keydown', e=>{ if(e.key==='Enter' || e.key===' ') open(); });
      return wrap;
    }

    function render(){
      const frag=document.createDocumentFragment();
      projects.forEach((p,idx)=>frag.appendChild(card(p,idx)));
      grid.innerHTML=''; grid.appendChild(frag);
    }

    function openLightbox(pIndex,imgIndex){
      cur.p=pIndex; cur.i=imgIndex;
      const p=projects[cur.p];
      setImgWithFallback(lightImg, `${IMG_BASE}/${p.id}/${p.images[cur.i]}`, `${IMG_FALLBACK}/${p.id}/${p.images[cur.i]}`);
      counter.textContent=`${cur.i+1} / ${p.images.length} · ${p.title||p.id}`;
      lightbox.classList.add('open');
    }
    function closeLightbox(){ lightbox.classList.remove('open'); }
    function prev(){ const p=projects[cur.p]; cur.i=(cur.i-1+p.images.length)%p.images.length; openLightbox(cur.p,cur.i); }
    function next(){ const p=projects[cur.p]; cur.i=(cur.i+1)%p.images.length; openLightbox(cur.p,cur.i); }

    btnClose.onclick=closeLightbox; btnPrev.onclick=prev; btnNext.onclick=next;
    lightbox.addEventListener('click',e=>{ if(e.target===lightbox) closeLightbox(); });
    window.addEventListener('keydown',e=>{ if(!lightbox.classList.contains('open')) return;
      if(e.key==='Escape') closeLightbox(); if(e.key==='ArrowLeft') prev(); if(e.key==='ArrowRight') next();
    });

    // 모바일 스와이프 제스처
    (()=>{ let sx=0,dx=0;
      lightbox.addEventListener('touchstart',e=>{sx=e.touches[0].clientX;},{passive:true});
      lightbox.addEventListener('touchmove',e=>{dx=e.touches[0].clientX-sx;},{passive:true});
      lightbox.addEventListener('touchend',()=>{ if(Math.abs(dx)>40){ dx<0?next():prev(); } sx=dx=0; });
    })();

    // projects.json 로드
    fetch('projects.json?v='+Date.now(),{cache:'no-store'})
      .then(r=>{ if(!r.ok) throw new Error('HTTP '+r.status); return r.json(); })
      .then(list=>{
        if(!Array.isArray(list)) throw new Error('JSON is not an array');
        // cover를 첫 번째로 보장
        projects=list.map(p=>{
          const imgs=Array.isArray(p.images)?[...p.images]:[];
          const i=imgs.indexOf(p.cover); if(i>0){ const [c]=imgs.splice(i,1); imgs.unshift(c); }
          return {...p, images:imgs};
        });
        // 최신 항목이 위로 오도록 뒤집기(원치 않으면 주석)
        projects.reverse();
        projects.length?render():grid.innerHTML='<p style="color:#9aa4b2">images/ 폴더에 프로젝트를 추가하세요. (각 폴더에 meta.txt 포함)</p>';
      })
      .catch(err=>{
        grid.innerHTML=`<p style="color:#f88">projects.json 불러오기 실패: ${String(err)}</p>`;
        console.error(err);
      });
  </script>
</body>
</html>
